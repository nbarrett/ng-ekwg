<app-page [ngClass]="{'busy': notifyTarget.busy}" area="home" pageTitle="Walks">
  <div class="row mb-n3">
    <div class="mb-3 col-sm-12">
      <div class="card sh-100">
        <div class="card-body"><h4
          class="card-title">Walks Programme</h4>
          <p class="card-text"></p>
          <app-walks-search [filterParameters]="filterParameters" [notifyTarget]="notifyTarget">
            <pagination class="pagination rounded" [boundaryLinks]=true [rotate]="true" [maxSize]="5"
                        [totalItems]="walks?.length" [(ngModel)]="pageNumber"
                        (pageChanged)="pageChanged($event)"></pagination>

          </app-walks-search>
          <div class="table-responsive"
               *ngFor="let displayedWalk of currentPageWalks; let index = index; trackBy: walkTracker">
            <div *ngIf="display.isExpanded(displayedWalk.walk)">
              <app-walk-view *ngIf="!display.isEdit(displayedWalk.walk)"
                             [displayedWalk]="displayedWalk"></app-walk-view>
              <app-walk-edit *ngIf="display.isEdit(displayedWalk.walk)"
                             [displayedWalk]="displayedWalk"></app-walk-edit>
            </div>
            <table *ngIf="!display.isExpanded(displayedWalk.walk)"
                   class="rounded table styled-table table-striped table-hover table-sm">
              <thead *ngIf="showTableHeader(displayedWalk)" class="styled-table">
              <tr>
                <th *ngIf="memberLoginService.memberLoggedIn()" width="7%">Action</th>
                <th width="13%">Walk Date</th>
                <th class="d-none d-lg-table-cell" width="7%">Start Time</th>
                <th width="32%">Walk Title</th>
                <th class="d-none d-lg-table-cell" width="7%">Distance</th>
                <th class="d-none d-lg-table-cell" width="8%">Postcode</th>
                <th class="d-none d-lg-table-cell" width="12%">Walk Leader</th>
                <th class="d-none d-lg-table-cell" width="11%">Contact Phone</th>
              </tr>
              </thead>
              <tbody>
              <tr [ngClass]="tableRowEven(displayedWalk)? 'default': 'active'">
                <td *ngIf="memberLoginService.memberLoggedIn()" width="7%" id="walkAction-{{index}}"
                    class="nowrap"><input
                  *ngIf="displayedWalk.walkAccessMode.walkWritable" type="submit"
                  value="{{displayedWalk.walkAccessMode.caption}}"
                  (click)="display.edit(displayedWalk)"
                  class="button-form">
                </td>
                <td width="13%" (click)="display.view(displayedWalk.walk)"
                    id="walkDate-{{index}}" class="nowrap">
                        <span [textContent]="displayedWalk.walk.walkDate|displayDate"
                              name="walkDate"></span></td>
                <td class="d-none d-lg-table-cell" width="7%" (click)="display.view(displayedWalk.walk)"
                    id="startTime-{{index}}">
                        <span [textContent]="viewWalkField(displayedWalk, 'startTime')"
                              name="startTime"></span>
                </td>
                <td width="32%" (click)="display.view(displayedWalk.walk)" name="briefDescriptionAndStartPoint"
                    id="briefDescription-{{index}}"
                    [textContent]="viewWalkField(displayedWalk, 'briefDescriptionAndStartPoint')"></td>
                <td class="d-none d-lg-table-cell" width="7%" (click)="display.view(displayedWalk.walk)" id="distance-{{index}}"
                    [textContent]="viewWalkField(displayedWalk, 'distance')" name="distance"></td>
                <td class="d-none d-lg-table-cell" width="8%" id="postcode-{{index}}">
                  <a [href]="'http://maps.google.co.uk/maps?q=' + viewWalkField(displayedWalk, 'postcode')"
                     target="_blank" [textContent]="viewWalkField(displayedWalk, 'postcode')"
                     name="postcode"
                     tooltip="Click to locate postcode {{viewWalkField(displayedWalk, 'postcode')}} on Google Maps"
                     tooltipPlacement="left"></a></td>
                <td class="d-none d-lg-table-cell" width="12%" id="contactEmail-{{index}}">
                  <a *ngIf="allowDetailView()" [href]="'mailto:'+ displayedWalk.walk.contactEmail"
                     [textContent]="displayedWalk.walk.displayName"
                     name="displayName"
                     tooltip="Click to email {{displayedWalk.walk.displayName}} at {{viewWalkField(displayedWalk, 'contactEmail')}}"
                     tooltipPlacement="left"></a>
                  <span class="tooltip-link" *ngIf="!allowDetailView()" tooltipPlacement="left"
                        (click)="loginOrLogout()" tooltipTrigger="mouseenter"
                        tooltip="Click again to login as an EKWG member and send an email to {{displayedWalk.walk.displayName}}"
                        [textContent]="displayedWalk.walk.displayName"></span></td>
                <td class="d-none d-lg-table-cell" width="11%" id="contactPhone-{{index}}">
                  <a *ngIf="allowDetailView()" [href]="'tel:' + displayedWalk.walk.contactPhone"
                     [textContent]="viewWalkField(displayedWalk, 'contactPhone')"
                     name="contactPhone"
                     tooltip="Click to ring {{displayedWalk.walk.displayName}} on {{viewWalkField(displayedWalk, 'contactPhone')}} (mobile devices only)"
                     tooltipPlacement="left"></a>
                  <a *ngIf="!allowDetailView()" [href]="'tel:' + displayedWalk.walk.contactPhone">
                            <span [textContent]="viewWalkField(displayedWalk, 'contactPhone')"
                                  name="contactPhone"
                                  tooltip="Click to ring {{displayedWalk.walk.displayName}} on {{viewWalkField(displayedWalk, 'contactPhone')}} (mobile devices only)"
                                  tooltipPlacement="left"></span></a>
                  <app-panel-expander class="d-none d-lg-table-cell" [walk]="displayedWalk.walk" [expandable]="true"
                                      [expandAction]="'full details'">
                  </app-panel-expander>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div [routerLink]="'/walks/information'" class="mb-3 col-sm-12" [ngClass]="allowAdminEdits() ? 'col-lg-6': 'col-lg-12'">
      <div class="card shadow clickable h-100">
        <img
          class="card-img-top"
          height="200" src="/api/aws/s3/imagesHome/f029e7e1-56aa-41dd-853a-0a8459c4fb94.jpg">
        <div class="card-body"><h4
          class="card-title"><a class="rams-text-decoration-pink external a-new">Walks information</a></h4>
          <div class="card-text">Find out about things you might need to know about before coming on a walk</div>
        </div>
      </div>
    </div>
    <div [routerLink]="'/walks/admin'" *ngIf="allowAdminEdits()" class="mb-3 col-sm-12 col-lg-6">
      <div class="card shadow clickable h-100">
        <img class="card-img-top"
             height="200" src="/api/aws/s3/imagesHome/fe76fd73-de42-4629-804e-a96b00ab4822.jpg">
        <div class="card-body"><h4
          class="card-title">
          <a class="rams-text-decoration-pink external">Admin Stuff</a></h4>
          <p class="card-text">Things that important people like Malc have to do when everyone else is asleep</p></div>
      </div>
    </div>
  </div>
</app-page>
