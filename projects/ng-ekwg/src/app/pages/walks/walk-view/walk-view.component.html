<app-panel-expander [walk]="displayedWalk.walk" [expandable]="allowWalkAdminEdits"
                    [collapsable]="true" [collapseAction]="'return to list view'">
</app-panel-expander>
<div class="row">
  <div class="col-sm-6 rounded">
    <div class="panel-toggle">
      <h1><span [textContent]="displayedWalk.walk.walkDate | displayDay" name="walkDate"></span> <span
        [textContent]="durationInFutureFor(displayedWalk.walk)" name="durationInFuture"
        class="badge event-badge blue-badge"></span> <span *ngIf="display.isNextWalk(displayedWalk.walk)"
                                                           class="badge event-badge next-event-badge"> Our next walk</span>
      </h1>
      <div *ngIf="displayedWalk.latestEventType.showDetails">
        <h2>
                        <span [textContent]="displayedWalk.walk.briefDescriptionAndStartPoint"
                              name="briefDescriptionAndStartPoint"></span>
        </h2>
        <h3 *ngIf="displayedWalk.walk.startTime">Start Time:
          <span
            [textContent]="displayedWalk.walk.startTime" name="startTime"></span>
        </h3>
      </div>
    </div>
    <input *ngIf="displayedWalk.walkAccessMode.walkWritable" type="submit"
           value="{{displayedWalk.walkAccessMode.caption}}"
           (click)="display.edit(displayedWalk)"
           title="{{displayedWalk.walkAccessMode.caption}}"
           class="button-form button-form-edit-event">

    <div *ngIf="displayedWalk.latestEventType.showDetails" class="event-description">
      <div class="green-bullets-no-rule">
        <p markdown [data]="displayedWalk.walk.longerDescription"></p>
      </div>
    </div>
    <div
      *ngIf="displayedWalk.latestEventType.showDetails && (displayedWalk.walk.meetupEventUrl || displayedWalk.walk.osMapsRoute || displayedWalk.walk.osMapsRoute || displayedWalk.walk.ramblersWalkId || displayedWalk.walkLink)"
      class="event-panel rounded event-panel-inner">
      <h1>Related Links</h1>

      <div *ngIf="displayedWalk.walk.meetupEventUrl" class="row related-links-row">
        <div class="col-sm-1">
          <img class="related-links-image"
               src="/assets/images/local/meetup.ico"
               alt="View {{meetupService.meetupPublishedStatus(displayedWalk)}} event on Meetup"/>
        </div>
        <div class="col-sm-11">
          <a target="_blank"
             [href]="displayedWalk.walk.meetupEventUrl">
            <span class="related-links-title"

                  tooltip="Click to view the route for this walk on Meetup">
              View {{meetupService.meetupPublishedStatus(displayedWalk)}} event on Meetup
            </span>
          </a>
        </div>
      </div>

      <div *ngIf="displayedWalk.walk.ramblersWalkId" class="row related-links-row">
        <div class="col-sm-1">
          <img class="related-links-image"
               src="favicon.ico"
               alt="View walk on Ramblers"/>
        </div>
        <div class="col-sm-11">
          <a target="_blank"
             class="follow"

             [href]="displayedWalk.ramblersLink"
             title="Preview on Ramblers Walks and Events Manager">
            <span class="related-links-title"

                  tooltip="Click to view on Ramblers Walks and Events Manager">
              View walk on Ramblers</span>
          </a>
        </div>
      </div>
      <div *ngIf="displayedWalk.walk.osMapsRoute" class="row related-links-row">
        <div class="col-sm-1">
          <img class="related-links-image"
               src="/assets/images/local/ordnance-survey-untitled.png"
               alt="View map on OS Maps"/>
        </div>
        <div class="col-sm-11">
          <a tooltip="Click to view the route for this walk on Ordnance Survey Maps"
             target="_blank"
             [href]="displayedWalk.walk.osMapsRoute">
            View map on OS Maps
          </a>
        </div>
      </div>
      <div class="row related-links-row"
           *ngIf="displayedWalk?.walk?.venue?.venuePublish && (displayedWalk?.walk?.venue?.url||displayedWalk?.walk?.venue?.postcode)">
        <div class="col-sm-12">
          <a tooltip="Click to visit {{displayedWalk.walk.venue.name}}"
             [href]="displayedWalk.walk.venue.url || googleMapsService.urlForPostcode(displayedWalk.walk.venue.postcode)"
             target="_blank">
            <fa-icon [icon]="displayedWalk.walk.venue.type | toVenueIcon" class="fa-icon"></fa-icon>
            {{displayedWalk.walk.venue.type}}: {{displayedWalk.walk.venue.name}}
          </a>
        </div>
      </div>
      <div class="row related-links-row" *ngIf="displayedWalk.walkLink">
        <div class="col-sm-12">
          <a popover="Link has been copied to clipboard"
             class="related-links-gylph-title"
             triggers="" #pop="bs-popover"
             (click)="display.copyWalkToClipboard(displayedWalk.walk, pop)"
             [outsideClick]="true"
             placement="bottom">
            <fa-icon [icon]="faCopy" class="fa-icon"><span
              tooltipPlacement="left"
              tooltip="Click to copy link to clipboard"></span></fa-icon>
            Copy link</a> to this <a [href]="displayedWalk.walkLink " target="_blank">walk</a>
        </div>
      </div>
    </div>
  </div>
  <div class="col-sm-6 rounded" *ngIf="displayedWalk.latestEventType.showDetails">
    <div class="row">
      <div class="col-sm-12">
        <iframe *ngIf="displayedWalk.walk.postcode" class="map-thumbnail-image"
                style="border:0;border-radius: 10px;"
                [src]="googleMapsUrl" allowfullscreen></iframe>
      </div>
    </div>
    <div class="row img-thumbnail thumbnail-campaign-settings">
      <div class="map-radio-heading map-radio-group">Show Map:</div>
      <div class="radio-inline map-radio-group map-radio-label" (click)="refreshView()">
        <input id="show-start-point" type="radio"
               [ngModel]="mapDisplay" name="mapDisplay"
               (ngModelChange)="changeShowDrivingDirections($event)"
               value="show-start-point"/>
        <label for="show-start-point">At start {{displayedWalk.walk.postcode}}</label>
        <input id="show-driving-directions" type="radio"
               (ngModelChange)="changeShowDrivingDirections($event)"
               [ngModel]="mapDisplay" name="mapDisplay"
               value="show-driving-directions"/>
        <label for="show-driving-directions">Driving from: <input
          class="input-sm text-uppercase input-postcode"
          [ngModel]="fromPostcode" name="fromPostcode"
          (ngModelChange)="changeFromPostcode($event)"
          (click)="autoSelectMapDisplay()"
          type="text"></label>

      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-sm-6 rounded">
    <div class="event-panel rounded">
      <h1>Walk Leader</h1>
      <div *ngIf="!displayedWalk.latestEventType.showDetails">
        <div class="col-sm-12">
          <p [textContent]="displayedWalk.latestEventType.description" name="description"></p>
        </div>
      </div>
      <div *ngIf="displayedWalk.latestEventType.showDetails">
        <p *ngIf="displayedWalk.walk.contactEmail">
          <a *ngIf="loggedIn" [href]="'mailto:' + displayedWalk.walk.contactEmail"
             tooltip="Click to email {{displayedWalk.walk.displayName}} at {{displayedWalk.walk.contactEmail}}">
            <fa-icon [icon]="faEnvelope" class="fa-icon"></fa-icon>
            {{displayedWalk.walk.displayName}}
          </a>
          <span *ngIf="!loggedIn" class="tooltip-link span-margin"
                tooltip-trigger="mouseenter"
                tooltip="Login as an EKWG member and send an email to {{displayedWalk.walk.displayName}}">
            {{displayedWalk.walk.displayName}}</span>
        </p>
        <p *ngIf="displayedWalk.latestEventType.showDetails">
          <fa-icon [icon]="faPhone" class="fa-icon"></fa-icon>
          <a [href]="'tel:' + displayedWalk.walk.contactPhone" name="contactPhone"
             tooltip="Click to ring {{displayedWalk.walk.displayName}} on {{displayedWalk.walk.contactPhone}} (mobile devices only)">
            {{displayedWalk.walk.contactPhone}}
          </a>
        </p>
      </div>
    </div>
  </div>
  <div class="col-sm-6 rounded">
    <div class="event-panel rounded">
      <h1>Walk Details</h1>
      <div *ngIf="!displayedWalk.latestEventType.showDetails">
        <div class="col-sm-12">
          <p [textContent]="displayedWalk.latestEventType.description" name="description"></p>
        </div>
      </div>
      <div *ngIf="displayedWalk.latestEventType.showDetails">
        <div class="row">
          <div class="col-sm-6">Postcode:
            <span [textContent]="displayedWalk.walk.location" name="location">ssss</span>
            <a tooltip="Click to locate postcode {{displayedWalk.walk.postcode}} on Google Maps"
               [href]="googleMapsService.urlForPostcode(displayedWalk.walk.postcode)" target="_blank">
              {{displayedWalk.walk.postcode}}</a>
          </div>
          <div class="col-sm-6">
            <div *ngIf="displayedWalk.walk.gridReference">Grid Ref:
              <a [href]="display.gridReferenceLink(displayedWalk.walk)"
                 tooltip="Click to locate grid reference {{displayedWalk.walk.gridReference}} on UK Grid Reference Finder"
                 target="_blank">{{displayedWalk.walk.gridReference}}</a>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6">Distance: {{displayedWalk.walk.distance}}</div>
          <div class="col-sm-6">Grade: {{displayedWalk.walk.grade}}</div>
        </div>
      </div>
    </div>
  </div>
</div>
