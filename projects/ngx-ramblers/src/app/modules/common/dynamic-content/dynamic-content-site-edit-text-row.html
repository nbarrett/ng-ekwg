<ng-container *ngIf="actions.isTextRow(row)">
  <div [class]="actions.rowClasses(row)">
    <ng-container *ngFor="let column of row?.columns; let columnIndex = index;">
      <div [class]="'col-sm-' + column.columns">
        <ng-container *ngIf="!column.rows">
          <app-markdown-editor (saved)="actions.saveContentTextId($event, rowIndex, column, pageContent)"
                               [buttonsAvailableOnlyOnFocus]="true"
                               [category]="contentPath"
                               [queryOnlyById]="true"
                               [clearEnabled]="true"
                               [description]="actions.rowColumnIdentifierFor(rowIndex, columnIndex, contentDescription)"
                               [id]="column?.contentTextId"
                               [initialView]="actions.view()"
                               [name]="actions.parentRowColFor(parentRowIndex, rowIndex, columnIndex)">
            <ng-container prepend>

              <div class="form-group">
                <label
                  [for]="actions.rowColumnIdentifierFor(rowIndex, columnIndex, 'access-level-' + contentPath)">Access:</label>
                <select [(ngModel)]="column.accessLevel"
                        [id]="actions.rowColumnIdentifierFor(rowIndex, columnIndex, 'access-level-' + contentPath)"
                        class="form-control input-sm">
                  <option *ngFor="let accessLevel of memberResourcesReferenceData.accessLevels()"
                          [textContent]="accessLevel.description"
                          [ngValue]="accessLevel.id">
                </select>
              </div>
              <div class="form-group">
                <label
                  [for]="actions.rowColumnIdentifierFor(rowIndex, columnIndex, 'column-width-' + contentPath)">Width:</label>
                <input #input (input)="actions.changeColumnWidthFor(input, column)"
                       [id]="actions.rowColumnIdentifierFor(rowIndex, columnIndex, 'column-width-' + contentPath)"
                       [value]="column.columns"
                       autocomplete="columns"
                       class="form-control input-sm" placeholder="Enter number of columns (1-12)"
                       type="number">
              </div>
              <div (click)="editImage(rowIndex, columnIndex)"
                   delay=500 tooltip="edit image" class="badge-button">
                <fa-icon [icon]="column.imageSource? faPencil : faAdd"></fa-icon>
                <span>{{column.imageSource ? 'edit' : 'add'}} image</span>
              </div>
              <app-actions-dropdown
                [columnIndex]="columnIndex"
                [pageContent]="pageContent"
                [column]="column"
                [row]="row">
              </app-actions-dropdown>
            </ng-container>
          </app-markdown-editor>
          <div *ngIf="imageSource(rowIndex, columnIndex, column?.imageSource) || editActive(rowIndex, columnIndex)"
               class="mt-2 mb-3">
            <app-image-cropper
              *ngIf="editActive(rowIndex, columnIndex)"
              [preloadImage]="column?.imageSource"
              (imageChange)="imageChanged(rowIndex, columnIndex, $event)"
              (quit)="exitImageEdit(rowIndex, columnIndex)"
              (save)="imagedSaved(rowIndex, columnIndex, column, $event)">
            </app-image-cropper>
            <app-card-image
              [unconstrainedHeight]="true"
              [imageSource]="imageSource(rowIndex, columnIndex, column?.imageSource)">
            </app-card-image>
            <label [for]="actions.rowColumnIdentifierFor(rowIndex,columnIndex,'image-source')">
              Image Source:</label>
            <input [(ngModel)]="column.imageSource"
                   [id]="actions.rowColumnIdentifierFor(rowIndex,columnIndex,'image-source')"
                   type="text" class="form-control">
          </div>
        </ng-container>
        <ng-container *ngIf="column.rows">
          <div class="img-thumbnail thumbnail-walk-edit mt-2"
               *ngFor="let row of column.rows; let nestedRowIndex = index;">
            <div class="thumbnail-heading">Row {{rowIndex + 1}} (nested row {{nestedRowIndex + 1}}
              column {{columnIndex + 1}}
              ({{stringUtils.pluraliseWithCount(row?.columns.length, 'column')}}))
            </div>
            <div class="row align-items-end mb-3">
              <div class="col-sm-4">
                <label [for]="actions.parentRowColumnIdentifierFor(parentRowIndex, nestedRowIndex, column, 'nested-margins-top' + contentPath)">Margin
                  Top:</label>
                <select [compareWith]="actions.marginComparer" class="form-control input-sm"
                        [id]="actions.parentRowColumnIdentifierFor(parentRowIndex, nestedRowIndex, column, 'nested-margins-top' + contentPath)"
                        [(ngModel)]="row.marginTop">
                  <option *ngFor="let margin of actions.margins"
                          [ngValue]="margin">{{margin || 'none'}}</option>
                </select>
              </div>
              <div class="col-sm-4">
                <label [for]="actions.parentRowColumnIdentifierFor(parentRowIndex, nestedRowIndex, column, 'nested-margins-bottom' + contentPath)">Margin
                  Bottom:</label>
                <select class="form-control input-sm"
                        [id]="actions.parentRowColumnIdentifierFor(parentRowIndex, nestedRowIndex, column,'nested-margins-bottom' + contentPath)"
                        [(ngModel)]="row.marginBottom">
                  <option *ngFor="let margin of actions.margins"
                          [ngValue]="margin">{{margin || 'none'}}</option>
                </select>
              </div>
              <div class="col-sm-4">
                <app-actions-dropdown [rowIndex]="nestedRowIndex"
                                      [pageContent]="pageContent"
                                      [column]="column"
                                      [row]="row">
                </app-actions-dropdown>
              </div>
            </div>
            <app-dynamic-content-site-edit-text-row
              [row]="row"
              [parentRowIndex]="rowIndex"
              [rowIndex]="nestedRowIndex"
              [contentDescription]="contentDescription"
              [contentPath]="contentPath"
              [pageContent]="pageContent">
            </app-dynamic-content-site-edit-text-row>
          </div>
        </ng-container>
      </div>
    </ng-container>
  </div>
</ng-container>
